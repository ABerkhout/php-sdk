# Transloadit PHP SDK

# Purpose

This is the official PHP SDK for the
[transloadit.com](http://transloadit.com/) API.

You can use it to setup file upload forms for your users, or to upload
existing files from your server.

## Examples

To get started, each of our examples requires that you create a new
Transloadit instance like this

    <?php
    require_once('/path/to/php-sdk/lib/transloadit/Transloadit.php');
    $transloadit = new Transloadit(array(
      'key' => 'your-key'
      'secret' => 'your-secret'
    ));

    // Example code goes here!

<!-- This section is generated by: make docs -->

### 1. Upload and resize an image from your server

This example demonstrates how you can use the sdk to create an assembly
on your server.

It takes a sample image file, uploads it to transloadit, and starts a
resizing job on it.

    <?php

    $response = $transloadit->createAssembly(array(
      'files' => array(dirname(__FILE__).'/fixture/straw-apple.jpg'),
      'params' => array(
        'steps' => array(
          'resize' => array(
            'robot' => '/image/resize',
            'width' => 200,
            'height' => 100,
          )
        )
      ),
      /*
      If you set `blocking` to true, this request will hang until
      transloadit has finished resizing the image.

      This is ok to do with small files, but it requires that the
      network connection remains uninterrupted for the whole time.

      So for bigger files you should use our `notify_url` parameter,
      which contacts your server when the processing is done.
      */
      'blocking' => false,
    ));

    // Show the results of the assembly we spawned
    echo '<pre>';
    print_r($response);
    echo '</pre>';


### 2. Create a simple end-user upload form

This example shows you how to create a simple transloadit upload form
that redirects back to your site after the upload is done.

Once the script receives the redirect request, the current status for
this assembly is shown using Transloadit::response().

Note: There is no guarantee that the assembly has already finished
executing by the time the `$response` is fetched. You should use
the `notify_url` parameter for this.

    <?php

    // Check if this request is a transloadit redirect_url notification.
    // If so fetch the response and output the current assembly status:
    $response = Transloadit::response();
    if ($response) {
      echo '<h1>Assembly status:</h1>';
      echo '<pre>';
      print_r($response);
      echo '</pre>';
      exit;
    }

    // This should work on most environments, but you might have to modify
    // this for your particular setup.
    $redirectUrl = sprintf(
      'http://%s%s',
      $_SERVER['HTTP_HOST'],
      $_SERVER['REQUEST_URI']
    );

    // Setup a simple file upload form that resizes an image to 200x100px
    echo $transloadit->createAssemblyForm(array(
      'params' => array(
        'steps' => array(
          'resize' => array(
            'robot' => '/image/resize',
            'width' => 200,
            'height' => 100,
          )
        ),
         // See note about this parameter from example 1
        'blocking' => false,
        'redirect_url' => $redirectUrl
      )
    ));
    ?>
    <h1>Pick an image to resize</h1>
    <input name="example_upload" type="file">
    <input type="submit" value="Upload">
    </form>


### 3. Integrate the jQuery plugin into the previous example


    <?php

    $response = Transloadit::response();
    if ($response) {
      echo '<h1>Assembly status:</h1>';
      echo '<pre>';
      print_r($response);
      echo '</pre>';
      exit;
    }

    $redirectUrl = sprintf(
      'http://%s%s',
      $_SERVER['HTTP_HOST'],
      $_SERVER['REQUEST_URI']
    );

    echo $transloadit->createAssemblyForm(array(
      'params' => array(
        'steps' => array(
          'resize' => array(
            'robot' => '/image/resize',
            'width' => 200,
            'height' => 100,
          )
        ),
        'blocking' => false,
        'redirect_url' => $redirectUrl
      )
    ));
    ?>
    <script type="text/javascript">
    var tlProtocol = (('https:' == document.location.protocol) ? 'https://' : 'http://');
    document.write(unescape("%3Cscript src='" + tlProtocol + "assets.transloadit.com/js/jquery.transloadit2.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
     $(document).ready(function() {
       $('form').transloadit();
     });
    </script>
    <h1>Pick an image to resize</h1>
    <input name="example_upload" type="file">
    <input type="submit" value="Upload">
    </form>

<!-- End of generated doc section -->

## API

### new Transloadit($properties = array());

Creates a new Transloadit base class and applies the given $properties array
to the instance.

### $transloadit->key = null;

The auth key of your transloadit account.

### $transloadit->secret = null;

The auth secret of your transloadit account.

### $transloadit->form($options = array())

Creates a new transloadit upload form including the hidden 'params' and
'signature' field. Available $options are:

* `'params'`:
  The instructions / steps / template for this assembly.
* `'expires'`:
  The time where the signature expires. Default: `'+2 hours'`.
* `'protocol'`:
  Can be `'http'` or `'https'`
* `'fields'`:
  An optional array with additional field value pairs to include as
  hidden fields into the form. This can be useful to send some
  data to transloadit that you'd like to be included in all status
  requests as well as notifications.
* `'url'`:
  You should generally not overwrite this.
